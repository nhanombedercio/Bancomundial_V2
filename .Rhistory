select(Provincia, AMADEU, MARTA, VICTOR)
incricoes_data<- left_join(incricoes_data, on, by="Provincia")%>%
select(Provincia, AMADEU, MARTA,VICTOR ,Online ) %>% rename(data=Provincia)
incricoes_data<-incricoes_data %>% mutate(Total_diario=AMADEU+MARTA+VICTOR+Online)
Total_sup<-c(as.factor("TOTAL"),sum(as.integer(incricoes_data$AMADEU)),sum(as.integer(incricoes_data$MARTA)),sum(as.integer(incricoes_data$VICTOR)),sum(as.integer(incricoes_data$Online)),sum(as.integer(incricoes_data$Total_diario)))
incricoes_data<-rbind(incricoes_data,Total_sup)
#################################################################################################
#################INSCRIÇOES E LEGIVEIS ##########################################
########################################################################################################
online_status<-realiza %>% filter(control_quest==1) %>% group_by(provincia_residencia,select) %>% summarise(n=n())
maputo_status_on<- online_status  %>% filter(provincia_residencia=="MAPUTO CIDADE") %>%
rename(MAPUTO=n, LEGIVEL=select) %>% select(!(provincia_residencia))
matola_status_on<-online_status  %>% filter(provincia_residencia=="MAPUTO PROVINCIA") %>%
rename(MATOLA=n, LEGIVEL=select) %>% select(!(provincia_residencia))
beira_status_on<-online_status  %>% filter(provincia_residencia=="SOFALA") %>%
rename(BEIRA=n, LEGIVEL=select) %>% select(!(provincia_residencia))
nampula_status_on<-online_status  %>% filter(provincia_residencia=="NAMPULA") %>%
rename(NAMPULA=n, LEGIVEL=select) %>% select(!(provincia_residencia))
manica_status<-online_status  %>%
filter(provincia_residencia=="MANICA") %>%  rename(MANICA=n, LEGIVEL=select)
Cdelgado_status<-online_status  %>% filter(provincia_residencia=="CABO DELGADO") %>%  rename(CaboD=n, LEGIVEL=select)
niassa_status<-online_status  %>%
filter(provincia_residencia=="NIASSA") %>%  rename(NIASSA=n, LEGIVEL=select)
#select(!(provincia_residencia))
online_status <-merge(niassa_status, Cdelgado_status, by = "LEGIVEL", all.x = TRUE, all.y = TRUE)
online_status <-merge(online_status, manica_status, by = "LEGIVEL", all.x = TRUE, all.y = TRUE)
online_status <-merge(online_status, nampula_status_on, by = "LEGIVEL", all.x = TRUE, all.y = TRUE)
online_status <-merge(online_status, matola_status_on, by = "LEGIVEL", all.x = TRUE, all.y = TRUE)
online_status <-merge(online_status, beira_status_on, by = "LEGIVEL", all.x = TRUE, all.y = TRUE)
online_status <-merge(online_status, maputo_status_on, by = "LEGIVEL", all.x = TRUE, all.y = TRUE)
online_status$Outra_provincia <- online_status$NIASSA+online_status$CaboD+online_status$MANICA
online_status  <- online_status  %>% select(LEGIVEL,MAPUTO, MATOLA, BEIRA, NAMPULA,Outra_provincia)
online_status[is.na(online_status)]<- 0
online_status$TOTAL<- online_status$MAPUTO+online_status$MATOLA+online_status$BEIRA+online_status$Outra_provincia+online_status$NAMPULA
online_status$LEGIVEL <- ifelse(online_status$LEGIVEL == "Não", "NAO LEGIVEL-ONLINE", online_status$LEGIVEL)
online_status$LEGIVEL <- ifelse(online_status$LEGIVEL == "Sim", "LEGIVEL-ONLINE", online_status$LEGIVEL)
##OfFLINE
offline_status<-realiza %>% filter(control_quest==2) %>% group_by(provincia_residencia,select) %>% summarise(n=n())
maputo_status_of<- offline_status  %>% filter(provincia_residencia=="MAPUTO CIDADE") %>%
rename(MAPUTO=n, LEGIVEL=select) %>% select(!(provincia_residencia))
matola_status_of<-offline_status  %>% filter(provincia_residencia=="MAPUTO PROVINCIA") %>%
rename(MATOLA=n, LEGIVEL=select) %>% select(!(provincia_residencia))
beira_status_of<-offline_status  %>% filter(provincia_residencia=="SOFALA") %>%
rename(BEIRA=n, LEGIVEL=select) %>% select(!(provincia_residencia))
nampula_status_of<-offline_status  %>% filter(provincia_residencia=="NAMPULA") %>%
rename(NAMPULA=n, LEGIVEL=select) %>% select(!(provincia_residencia))
manica_statusof<-offline_status  %>%
filter(provincia_residencia=="MANICA") %>%  rename(MANICA=n, LEGIVEL=select)
Cdelgado_statusof<-offline_status  %>% filter(provincia_residencia=="CABO DELGADO") %>%  rename(CaboD=n, LEGIVEL=select)
niassa_statusof<-offline_status  %>%
filter(provincia_residencia=="NIASSA") %>%  rename(NIASSA=n, LEGIVEL=select)
#select(!(provincia_residencia))
offline_status <-merge(niassa_statusof, Cdelgado_statusof, by = "LEGIVEL", all.x = TRUE, all.y = TRUE)
offline_status <-merge(offline_status, manica_statusof, by = "LEGIVEL", all.x = TRUE, all.y = TRUE)
offline_status <-merge(offline_status, nampula_status_of, by = "LEGIVEL", all.x = TRUE, all.y = TRUE)
offline_status <-merge(offline_status, matola_status_of, by = "LEGIVEL", all.x = TRUE, all.y = TRUE)
offline_status <-merge(offline_status, beira_status_of, by = "LEGIVEL", all.x = TRUE, all.y = TRUE)
offline_status <-merge(offline_status, maputo_status_of, by = "LEGIVEL", all.x = TRUE, all.y = TRUE)
offline_status$Outra_provincia <- offline_status$NIASSA+offline_status$CaboD+offline_status$MANICA
offline_status  <- offline_status  %>% select(LEGIVEL,MAPUTO, MATOLA, BEIRA, NAMPULA,Outra_provincia)
offline_status[is.na(offline_status)]<- 0
offline_status$TOTAL<- offline_status$MAPUTO+offline_status$MATOLA+offline_status$BEIRA+offline_status$Outra_provincia+offline_status$NAMPULA
offline_status$LEGIVEL <- ifelse(offline_status$LEGIVEL == "Não", "NAO LEGIVEL-OFFLINE", offline_status$LEGIVEL)
offline_status$LEGIVEL <- ifelse(offline_status$LEGIVEL == "Sim", "LEGIVEL-OFFLINE", offline_status$LEGIVEL)
#TOTAL_LEGIVELof<-c("TOTAL",sum(offline_status$MAPUTO.x),sum(offline_status$MATOLA.x),sum(offline_status$NAMPULA.x),sum(offline_status$BEIRA.x),sum(offline_status$TOTAL.x))
inscricoes_status <-merge(offline_status, online_status, by = "LEGIVEL",all.x = TRUE, all.y = TRUE)
inscricoes_status[is.na(inscricoes_status)]<- 0
inscricoes_status$MAPUTO.x<-inscricoes_status$MAPUTO.x+inscricoes_status$MAPUTO.y
inscricoes_status$MATOLA.x<-inscricoes_status$MATOLA.x+inscricoes_status$MATOLA.y
inscricoes_status$NAMPULA.x<-inscricoes_status$NAMPULA.x+inscricoes_status$NAMPULA.y
inscricoes_status$BEIRA.x<-inscricoes_status$BEIRA.x+inscricoes_status$BEIRA.y
inscricoes_status$Outra_provincia.x<-inscricoes_status$Outra_provincia.x+inscricoes_status$Outra_provincia.y
inscricoes_status$TOTAL.x<-inscricoes_status$TOTAL.x+inscricoes_status$TOTAL.y
inscricoes_status <- inscricoes_status   %>%
select(LEGIVEL,MAPUTO.x,MATOLA.x,NAMPULA.x,BEIRA.x,Outra_provincia.x,TOTAL.x)
#incricoes_data<-rbind(incricoes_data,Total_sup)
########################################################################################################
offline_status<-realiza %>% filter(control_quest==2) %>% group_by(provincia_residencia,select) %>% summarise(n=n())
#########MOTIVO dE LEGIBILIDADE
selecionadas <-realiza %>% filter(select=="Sim") ## selecionadas
select_motivo<-   data.frame(table(selecionadas$inform_select,selecionadas$provincia_residencia))%>%
rename(Provincia=Var2, motivo=Var1) ## motivos selecionadas
maputo_sel_mot<- select_motivo %>% filter(Provincia=="MAPUTO CIDADE") %>%
rename(Maputo=Freq)
matola_sel_mot<- select_motivo %>% dplyr::filter(Provincia=="MAPUTO PROVINCIA") %>%
rename(Matola=Freq)
data_sel<-left_join(matola_sel_mot, maputo_sel_mot, by="motivo") %>%
select(!(Provincia.y)) %>% select(!(Provincia.x))
namp_sel_mot<- select_motivo %>% dplyr::filter(Provincia=="NAMPULA") %>%
rename(Nampula=Freq)
data_sel<-left_join(data_sel, namp_sel_mot, by = "motivo")%>% select(!(Provincia))
BEIRA_sel_mot<- select_motivo %>% dplyr::filter(Provincia=="SOFALA") %>%
rename(Beira=Freq)
data_sel<-left_join(data_sel, BEIRA_sel_mot, by = "motivo")
data_sel<- data_sel%>% select(!(Provincia)) %>% mutate(TOTAL=data_sel$Matola+Maputo+Nampula+Beira)
#_______________________________________________________________________________________________________
#############NAO SELECIONADAS##########################################################################
nao_selecionadas <-realiza %>% filter(select=="Não",control_quest==2)
Nao_select_motivo<-data.frame(table(nao_selecionadas$inform_select,nao_selecionadas$provincia_residencia)
) %>%  rename(Provincia=Var2, motivo=Var1)
maputo_Nsel_mot<- Nao_select_motivo %>% filter(Provincia=="MAPUTO CIDADE") %>%
rename(Maputo=Freq)
matola_Nsel_mot<- Nao_select_motivo %>% dplyr::filter(Provincia=="MAPUTO PROVINCIA") %>%
rename(Matola=Freq)
data<-left_join(matola_Nsel_mot, maputo_Nsel_mot, by="motivo") %>%
select(!(Provincia.y)) %>% select(!(Provincia.x))
namp_Nsel_mot<- Nao_select_motivo %>% dplyr::filter(Provincia=="NAMPULA") %>%
rename(Nampula=Freq)
data<-left_join(data, namp_Nsel_mot, by = "motivo") %>%
select(!(Provincia))
BEIRA_Nsel_mot<- Nao_select_motivo %>% dplyr::filter(Provincia=="SOFALA") %>%
rename(Beira=Freq)
data<-left_join(data, BEIRA_Nsel_mot, by = "motivo")
data<- data%>% select(!(Provincia)) %>% mutate(TOTAL=data$Matola+data$Maputo+data$Nampula+data$Beira)
###NAO SELECIO ONLINE
nao_selecionadason <-realiza %>% filter(select=="Não",control_quest==1)
Nao_select_motivoon<-data.frame(table(nao_selecionadason$inform_select,nao_selecionadason$provincia_residencia)
) %>%  rename(Provincia=Var2, motivo=Var1)
maputo_Nsel_moton<- Nao_select_motivoon %>% filter(Provincia=="MAPUTO CIDADE") %>%
rename(Maputo=Freq)
matola_Nsel_mot<- Nao_select_motivoon %>% dplyr::filter(Provincia=="MAPUTO PROVINCIA") %>%
rename(Matola=Freq)
dataon<-left_join(matola_Nsel_mot, maputo_Nsel_moton, by="motivo") %>%
select(!(Provincia.y)) %>% select(!(Provincia.x))
namp_Nsel_mot<- Nao_select_motivoon %>% dplyr::filter(Provincia=="NAMPULA") %>%
rename(Nampula=Freq)
dataon<-left_join(data, namp_Nsel_mot, by = "motivo") %>%
select(!(Provincia))
BEIRA_Nsel_mot<- Nao_select_motivoon %>% dplyr::filter(Provincia=="SOFALA") %>%
rename(Beira=Freq)
dataon<-left_join(dataon, BEIRA_Nsel_mot, by = "motivo")
dataon<- dataon %>% select(!(Provincia))
dataon$TOTAL<dataon$Matola+dataon$Maputo+dataon$Nampula+dataon$Beira
#################################################################################################3
Inscritas_online<-data.frame(table(realiza$provincia_residencia, realiza$control_quest))%>%
rename(Provincia=1, fonte=2) %>% filter(fonte==1)
Inscritas_offline<-data.frame(table(realiza$provincia_residencia, realiza$control_quest))%>%
rename(Provincia=1, fonte=2) %>% filter(fonte==2)
Inscritas<-left_join(Inscritas_offline, Inscritas_online, by="Provincia")%>%
select(!(fonte.y)) %>% select(!(fonte.x)) %>%
rename(Offline=Freq.x, online=Freq.y )%>% mutate(TOTAL= online+Offline)
Total<-c("TOTAL",sum(as.integer(Inscritas$online)),sum(as.integer(Inscritas$Offline)),sum(as.integer(Inscritas$TOTAL)))
Inscritas<-rbind(Inscritas,Total)
Inscritas[is.na(Inscritas)]<-"TOTAL"
View(Inscritas)
Inscritas<-rbind(Inscritas,Total)
shiny::runApp()
runApp()
### Grafico sessao obrigatoria por todo
grafico_cresca_Obr_all<- presenca_obr_cresca_all %>%
ggplot() +
aes(text =paste("Presenciais:", n, "de",tab_cresca_cidade$n, "nas listas de BM"),
x = Cidade, y = n, fill=Cidade) +
geom_col() +
scale_fill_hue(direction = 1) +
theme_bw()+
scale_fill_manual(name = "",
values = palette)+
labs(
y = "Numero de mulheres",
x = ""
)+theme(axis.text.x = element_text(angle = 0,
size = 10),
axis.text.y = element_text(size = 12)) +
geom_point(data=tab_cresca_cidade,
aes(text =paste("Numero de empreendedoras:", n, "da lista do banco"),x=Cidade, y=n),shape = "triangle down filled",
size =2, colour = "#112446")+
scale_y_continuous(limits = c(0,170), breaks = seq(0,170,by=20))
####Grafico SGR
install_data_packages()
#######participantes
###SGR
filtro_cresca <- selectInput("by_cresca",
label = h4("Números da operação por:"),
choices = c("Seu todo", "por cidade"))
###SGR obrigatorias
filtro_cresca_obr <- selectInput("by_cresca_obr",
label = h4("Números da operação por:"),
choices = c("Seu todo", "por trimestre"))
### tabela que calcula o numero de empreendedoras presentes por sessao por seu todo
presencas_cresca_all<-all_presencas %>% dplyr::filter(presente==TRUE) %>%
group_by(Grupo, grupo_accronym,actividade, presente)  %>%
summarise(n=n())
if (!requireNamespace(package, quietly = TRUE)) {
install.packages(package)
} else {
print("PACOTE INSTALADO E CARREGADO")
}
################################################################################
####################### FUNCOES PARA APP SUSAMATI ###########################################
################################################################################
##Funcao para instalar pacotes importantes
install_data_packages <- function() {
packages <- c("ggthemes","RColorBrewer","esquisse", "sf","shiny", "shinythemes", "shinydashboard", "shinyWidgets", "DT", "ggplot2",  "plotly", "flexdashboard", "shinyjs","tidyverse", "data.table", "dplyr", "readr", "readxl", "googlesheets4", "jsonlite", "httr", "stringr", "lubridate", "janitor")
# Verifica se cada pacote da lista está instalado e instala se não estiver
# Verifica se cada pacote da lista está instalado e instala se não estiver
for (package in packages) {
if (!requireNamespace(package, quietly = TRUE)) {
install.packages(package)
} else {
print("PACOTE INSTALADO E CARREGADO")
}
}
# Carrega todos os pacotes instalados
#library(packages)
# Carrega todos os pacotes instalados
lapply(packages, library, character.only = TRUE)
print("PACOTE INSTALADO E CARREGADO")
}
####Grafico SGR
install_data_packages()
#######participantes
###SGR
filtro_cresca <- selectInput("by_cresca",
label = h4("Números da operação por:"),
choices = c("Seu todo", "por cidade"))
###SGR obrigatorias
filtro_cresca_obr <- selectInput("by_cresca_obr",
label = h4("Números da operação por:"),
choices = c("Seu todo", "por trimestre"))
### tabela que calcula o numero de empreendedoras presentes por sessao por seu todo
presencas_cresca_all<-all_presencas %>% dplyr::filter(presente==TRUE) %>%
group_by(Grupo, grupo_accronym,actividade, presente)  %>%
summarise(n=n())
##Criar base de dados
setwd("C:/Users/Dercio/OneDrive - ASSOCIAÇÃO PARA O EMPODERAMENTO DA RAPARIGA-MUVA/Linkadosssss 2023/PROJECTOS/SISTEMA DE MONITORIA/Bancomundial_V2")
## gravar as base de dados.
all_presencas <- readRDS("data/1.zoho/3.clean/all_presencas.rds")
fnm_presenca <- readRDS("data/1.zoho/3.clean/fnm.rds")
sgr_presencas <- readRDS("data/1.zoho/3.clean/sgr.rds")
emprendedoras <- readRDS("data/0look_ups/emprendedoras.rds")
emprendedoras_cresca=emprendedoras %>% dplyr::filter(grupo_accronym=="SGR")
####Grafico SGR
install_data_packages()
#######participantes
###SGR
filtro_cresca <- selectInput("by_cresca",
label = h4("Números da operação por:"),
choices = c("Seu todo", "por cidade"))
###SGR obrigatorias
filtro_cresca_obr <- selectInput("by_cresca_obr",
label = h4("Números da operação por:"),
choices = c("Seu todo", "por trimestre"))
### tabela que calcula o numero de empreendedoras presentes por sessao por seu todo
presencas_cresca_all<-all_presencas %>% dplyr::filter(presente==TRUE) %>%
group_by(Grupo, grupo_accronym,actividade, presente)  %>%
summarise(n=n())
### tabela que calcula o numero de empreendedoras presentes por sessao por cada cidade
presencas_cresca_cidade<-all_presencas %>% dplyr::filter(presente==TRUE ) %>%
group_by(Cidade, Grupo, grupo_accronym,actividade, presente)  %>%
summarise(n=n())
###tabela que calcula numero de empreendedoras por cidade
## sera utilizado para tracar as linhas pretas no grafico
tab_cresca_cidade<-emprendedoras_cresca %>% filter(grupo_accronym %in% "SGR") %>%
group_by(Cidade) %>% summarise(n=n())
##grafico de cresca por todo
grafico_cresca_all<-  presencas_cresca_all %>% filter(grupo_accronym %in% "SGR") %>%
ggplot() +
aes(text =paste("Presenciais:", n, "de", nrow(emprendedoras_cresca), "nas listas de BM"), x = actividade, y = n,fill = grupo_accronym) +
geom_col() +
scale_fill_hue(direction = 1) +
theme_bw() +scale_fill_manual(name = "",
values = palette)+labs(
y = "Numero de mulheres",
x = ""
)+theme(axis.text.x = element_text(angle = 90,
size = 10),
axis.text.y = element_text(size = 12)) +
geom_hline(aes(yintercept=nrow(emprendedoras_cresca)))+
scale_y_continuous(limits = c(0,400), breaks = seq(0,400,by=50))
##grafico de cresca por cidade
grafico_cresca_cidade<-presencas_cresca_cidade %>% filter(grupo_accronym %in% "SGR") %>%
ggplot() +
aes(text =paste("Presenciais:", n, "de",tab_cresca_cidade$n, "nas listas de BM"), x = actividade, y = n, fill = Cidade) +
geom_col() +
scale_fill_hue(direction = 1) +
theme_bw()+ facet_wrap(vars(Cidade))+
scale_fill_manual(name = "",
values = palette)+
labs(
y = "Numero de mulheres",
x = ""
)+theme(axis.text.x = element_text(angle = 90,
size = 10),
axis.text.y = element_text(size = 12)) +
geom_hline(data=tab_cresca_cidade,
aes(yintercept= n))+facet_wrap(vars(Cidade))+
scale_y_continuous(limits = c(0,170), breaks = seq(0,170,by=50))
#######Sessoes obrigatorias
presenca_obr_cresca_all=all_presencas %>% filter(grupo_accronym %in% "SGR", presente==TRUE, actividade!="Sessão Inaugural")  %>%
group_by(Cidade,Emprendedora) %>% summarise(n=n())  %>% filter(n>=12) %>% group_by(Cidade) %>% summarise(n=n())
### Grafico sessao obrigatoria por todo
grafico_cresca_Obr_all<- presenca_obr_cresca_all %>%
ggplot() +
aes(text =paste("Presenciais:", n, "de",tab_cresca_cidade$n, "nas listas de BM"),
x = Cidade, y = n, fill=Cidade) +
geom_col() +
scale_fill_hue(direction = 1) +
theme_bw()+
scale_fill_manual(name = "",
values = palette)+
labs(
y = "Numero de mulheres",
x = ""
)+theme(axis.text.x = element_text(angle = 0,
size = 10),
axis.text.y = element_text(size = 12)) +
geom_point(data=tab_cresca_cidade,
aes(text =paste("Numero de empreendedoras:", n, "da lista do banco"),x=Cidade, y=n),shape = "triangle down filled",
size =2, colour = "#112446")+
scale_y_continuous(limits = c(0,170), breaks = seq(0,170,by=20))
###### Grafico sessao obrigatoria trimestre
grafico_cresca_Obr_all<- presenca_obr_cresca_all %>%
ggplot() +
aes(text =paste("Presenciais:", n, "de",tab_cresca_cidade$n, "nas listas de BM"),
x = Cidade, y = n, fill=Cidade) +
geom_col() +
scale_fill_hue(direction = 1) +
theme_bw()+
scale_fill_manual(name = "",
values = palette)+
labs(
y = "Numero de mulheres",
x = ""
)+theme(axis.text.x = element_text(angle = 0,
size = 10),
axis.text.y = element_text(size = 12)) +
geom_point(data=tab_cresca_cidade,
aes(text =paste("Numero de empreendedoras:", n, "da lista do banco"),x=Cidade, y=n),shape = "triangle down filled",
size =2, colour = "#112446")+
scale_y_continuous(limits = c(0,170), breaks = seq(0,170,by=20))
grafico_cresca_Obr_all
grafico_cresca_Obr_all<- presenca_obr_cresca_all %>%
ggplot() +
aes(x = Cidade, y = n, fill=Cidade) +
geom_col() +
scale_fill_hue(direction = 1) +
theme_bw()+
scale_fill_manual(name = "",
values = palette)+
labs(
y = "Numero de mulheres",
x = ""
)+theme(axis.text.x = element_text(angle = 0,
size = 10),
axis.text.y = element_text(size = 12)) +
geom_point(data=tab_cresca_cidade,
aes(text =paste("Numero de empreendedoras:", n, "da lista do banco"),x=Cidade, y=n),shape = "triangle down filled",
size =2, colour = "#112446")+
scale_y_continuous(limits = c(0,170), breaks = seq(0,170,by=20))
grafico_cresca_Obr_all
grafico_cresca_Obr_all<- presenca_obr_cresca_all %>%
ggplot() +
aes(x = Cidade, y = n, fill=Cidade) +
geom_col() +
scale_fill_hue(direction = 1) +
theme_bw()+
scale_fill_manual(name = "",
values = palette)+
labs(
y = "Numero de mulheres",
x = ""
)+theme(axis.text.x = element_text(angle = 0,
size = 10),
axis.text.y = element_text(size = 12)) +
geom_point(data=tab_cresca_cidade,
aes(x=Cidade, y=n),shape = "triangle down filled",
size =2, colour = "#112446")+
scale_y_continuous(limits = c(0,170), breaks = seq(0,170,by=20))
grafico_cresca_Obr_all
palette <- c("#A45EDA", "#F77333", "#5DD4C8", "#4497FD", "blue",
"pink", "orange", "black", "green",
"#D6B5ED", "FA8F5C")
grafico_cresca_Obr_all<- presenca_obr_cresca_all %>%
ggplot() +
aes(x = Cidade, y = n, fill=Cidade) +
geom_col() +
scale_fill_hue(direction = 1) +
theme_bw()+
scale_fill_manual(name = "",
values = palette)+
labs(
y = "Numero de mulheres",
x = ""
)+theme(axis.text.x = element_text(angle = 0,
size = 10),
axis.text.y = element_text(size = 12)) +
geom_point(data=tab_cresca_cidade,
aes(x=Cidade, y=n),shape = "triangle down filled",
size =2, colour = "#112446")+
scale_y_continuous(limits = c(0,170), breaks = seq(0,170,by=20))
grafico_cresca_Obr_all
View(presencas_cresca_all)
View(presenca_obr_cresca_all)
presenca_obr_cresca_all=all_presencas %>% filter(grupo_accronym %in% "SGR", presente==TRUE, actividade!="Sessão Inaugural")  %>%
group_by(Cidade,Emprendedora) %>% summarise(n=n())
View(presenca_obr_cresca_all)
presenca_obr_cresca_all=all_presencas %>% filter(grupo_accronym %in% "SGR", presente==TRUE, actividade!="Sessão Inaugural")  %>%
group_by(Cidade) %>% summarise(n=n())
View(presenca_obr_cresca_all)
presenca_obr_cresca_all=all_presencas %>% filter(grupo_accronym %in% "SGR", presente==TRUE, actividade!="Sessão Inaugural")  %>%
group_by(Cidade,Emprendedora) %>% summarise(n=n())  %>% filter(n>=12) %>% group_by(Cidade)
View(presenca_obr_cresca_all)
presenca_obr_cresca_all=all_presencas %>% filter(grupo_accronym %in% "SGR", presente==TRUE, actividade!="Sessão Inaugural")  %>%
group_by(Cidade,Emprendedora) %>% summarise(n=n())  %>% filter(n>=12) %>% group_by(Cidade) %>% summarise(n=n())
presenca_obr_cresca_all=all_presencas %>% filter(grupo_accronym %in% "SGR", presente==TRUE, actividade!="Sessão Inaugural")  %>%
group_by(Cidade,Emprendedora) %>% summarise(n=n())  %>% filter(n>=12) %>% group_by(Cidade) %>% summarise(n=n())
#text =paste("Presenciais:", n, "de",tab_cresca_cidade$n, "nas listas de BM")
##text =paste("Numero de empreendedoras:", n, "da lista do banco")
### Grafico sessao obrigatoria por todo
grafico_cresca_Obr_all<- presenca_obr_cresca_all %>%
ggplot() +
aes(x = Cidade, y = n, fill=Cidade) +
geom_col() +
scale_fill_hue(direction = 1) +
theme_bw()+
scale_fill_manual(name = "",
values = palette)+
labs(
y = "Numero de mulheres",
x = ""
)+theme(axis.text.x = element_text(angle = 0,
size = 10),
axis.text.y = element_text(size = 12)) +
geom_point(data=tab_cresca_cidade,
aes(x=Cidade, y=n),shape = "triangle down filled",
size =2, colour = "#112446")+
scale_y_continuous(limits = c(0,170), breaks = seq(0,170,by=20))
grafico_cresca_Obr_all
all_presencas$abordagem <- ""
replace(all_presencas$abordagem, all_presencas$actividade==1.1, "SGR")
table(all_presencas$abordagem)
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.1, "SGR")
table(all_presencas$abordagem)
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.3, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.1, "SGR")
table(all_presencas$abordagem)
table(all_presencas$actividade,all_presencas$abordagem )
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.3, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.3, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==3.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==3.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==3.3, "SGR")
table(all_presencas$abordagem)
View(all_presencas)
table(all_presencas$actividade,all_presencas$abordagem)
str(all_presencas$actividade)
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.3, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.3, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==3.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==3.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==3.3, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Sessao de encerramento de parceiros", "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Sessao intercalar de parceiros", "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Sessões de coaching", "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Sessao intercalar de parceiros", "SGR")
table(all_presencas$actividade,all_presencas$abordagem)
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.3, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.3, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==3.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==3.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==3.3, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Sessao de encerramento de parceiros", "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Sessao intercalar de parceiros", "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Sessões de coaching", "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Introducao a sessao de parceiros", "SGR")
table(all_presencas$actividade,all_presencas$abordagem)
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.3, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.3, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==3.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==3.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==3.3, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Sessao de encerramento de parceiros", "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Sessao intercalar de parceiros", "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Sessões de coaching", "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Introducao a sessao de parceiros", "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="", "FNM")
table(all_presencas$actividade,all_presencas$abordagem)
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==1.3, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==2.3, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==3.1, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==3.2, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade==3.3, "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Sessao de encerramento de parceiros", "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Sessao intercalar de parceiros", "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Sessões de coaching", "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$actividade=="Introducao a sessao de parceiros", "SGR")
all_presencas$abordagem<-replace(all_presencas$abordagem, all_presencas$abordagem=="", "FNM")
table(all_presencas$actividade,all_presencas$abordagem)
runApp()
